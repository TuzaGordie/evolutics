<!-- <app-form-navigation [title]="'Set Up / Process Design / Control '"></app-form-navigation> -->


<loader [loading]="loading" [text]="loadingText">
  <div class="">
    <ul class="nav nav-pills nav-justified mb-3" id="pills-tab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home"
          type="button" role="tab" aria-controls="pills-home" aria-selected="true">{{'Basic'|appTranslate|async}}
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-profile"
          type="button" role="tab" aria-controls="pills-profile" aria-selected="false">{{'Product'|appTranslate|async}}
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="pills-contact-tab" data-bs-toggle="pill" data-bs-target="#pills-contact"
          type="button" role="tab" aria-controls="pills-contact" aria-selected="false">{{'Payout'|appTranslate|async}}
        </button>
      </li>
    </ul>
    <div class="tab-content" id="pills-tabContent">
      <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
        <div class="row justify-content-center">
          <div class="col-4">
            <div class="row mt-5">
              <div class="col">
                <div class="form-group">
                  <label for="" class="  text-primary">{{"Company Code"|appTranslate|async}}</label>
                  <select (change)="getControlByCompanyCode()" class="form-control control-bg-gray"
                    [(ngModel)]="createControlPayout.controlPayout.companyCode">
                    <option></option>
                    <option *ngFor="let item of companies" [value]="item.code">
                      {{item.code}} - {{item.description}}
                    </option>
                  </select>
                </div>
              </div>

            </div>


          </div>
        </div>
        <div class="row mt-5 text-center">
          <div class="col-md-4">
            <app-input-ngmodel label="Require Control Approval for Suspense
            switches" [stacked]="true" [mini]="true" type="checkbox"
              [(model)]="createControlPayout.controlPayout.controlSuspenseSwitch"></app-input-ngmodel>
          </div>
          <div class="col-md-4">
            <app-input-ngmodel label="Require Control Approval for Policy
            Accounting" [stacked]="true" [mini]="true" type="checkbox"
              [(model)]="createControlPayout.controlPayout.controlPolicyAccount"></app-input-ngmodel>
          </div>
          <div class="col-md-4">
            <app-input-ngmodel label="Auth Admin Endorsements" [stacked]="true" [mini]="true" type="checkbox"
              [(model)]="createControlPayout.controlPayout.authAdminEndorse"></app-input-ngmodel>
          </div>
          <div class="col-md-4">
            <app-input-ngmodel label="Auth Agent Endorsements" [stacked]="true" [mini]="true" type="checkbox"
              [(model)]="createControlPayout.controlPayout.authAgentEndorse"></app-input-ngmodel>
          </div>
          <div class="col-md-4">
            <app-input-ngmodel label="Auth Client Endorsements" [stacked]="true" [mini]="true" type="checkbox"
              [(model)]="createControlPayout.controlPayout.authClientEndorse"></app-input-ngmodel>
          </div>
          <div class="col-md-4">
            <app-input-ngmodel label="Auth Policy Endorsements" [stacked]="true" [mini]="true" type="checkbox"
              [(model)]="createControlPayout.controlPayout.authPolicyEndorse"></app-input-ngmodel>
          </div>
          <div class="col-md-4">
            <app-input-ngmodel label="Auth Provider Endorsements" [stacked]="true" [mini]="true" type="checkbox"
              [(model)]="createControlPayout.controlPayout.authProviderEndorse"></app-input-ngmodel>
          </div>
          <div class="col-md-4">
            <app-input-ngmodel label="Auth Rate Endorsements" [stacked]="true" [mini]="true" type="checkbox"
              [(model)]="createControlPayout.controlPayout.authRateEndorse"></app-input-ngmodel>
          </div>
          <div class="col-md-4">
            <app-input-ngmodel label="Auth Setup Endorsements" [stacked]="true" [mini]="true" type="checkbox"
              [(model)]="createControlPayout.controlPayout.authSetupEndorse"></app-input-ngmodel>
          </div>
          <div class="col-md-4">
            <app-input-ngmodel label="Automate Treaty Allocations" [stacked]="true" [mini]="true" type="checkbox"
              [(model)]="createControlPayout.controlPayout.autoTreaty"></app-input-ngmodel>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
        <div class="row mt-3 justify-content-end">
          <div class="col-auto">
            <div class="form-group">
              <label for="" class=" text-primary">{{'Company Code'|appTranslate|async}}</label>
              <select class="form-control control-bg-gray" [disabled]="true"
                [value]="createControlPayout.controlPayout.companyCode">
                <option value=""></option>
                <option *ngFor="let item of companies" [value]="item.code">
                  {{item.code}} - {{item.description}}
                </option>
              </select>
            </div>
          </div>
        </div>

        <div class="border p-2 rounded mt-3" *ngFor="let controlPayoutProduct of createControlPayout.controlPayoutProduct; let i = index">
          <div class="row align-items-center">
            <div class="col-md">
              <div class="justify-content-center row ">
                <div class="col-md-2 ">
                  <div class="form-group">
                    <label for="" class="text-primary small1">{{"Product Class "|appTranslate|async}}</label>
                    <select [(ngModel)]="controlPayoutProduct.prodClass" name="" id=""
                      class="form-control control-bg-gray">
                      <option value=""></option>
                      <option *ngFor="let item of productClasses" [value]="item.code">
                        {{item.code}} - {{item.title}}
                      </option>
                    </select>
                  </div>
                </div>
                <div class="col-md-2 ">
                  <div class="form-group">
                    <label for="" class="text-primary small1">{{"PayOut Ratio Check (%)"|appTranslate|async}}</label>
                    <input type="number" [(ngModel)]="controlPayoutProduct.payoutRatioCheck"
                      class="form-control control-bg-gray">
                  </div>
                </div>
                <div class="col-md-3 ">
                  <div class="form-group">
                    <label for=""
                      class="text-primary small1">{{"Days of Policy Activation to claim check "|appTranslate|async}}</label>
                    <input type="number" [(ngModel)]="controlPayoutProduct.daysPolActiveToClaim"
                      class="form-control control-bg-gray">
                  </div>
                </div>
                <div class="col-md-3 ">
                  <div class="form-group">
                    <label for="" class="text-primary small1">{{"Suspicious Premium Threshold"|appTranslate|async}}</label>
                    <input type="number" [(ngModel)]="controlPayoutProduct.suspiciousPremThreshold"
                      class="form-control control-bg-gray" />
                  </div>
                </div>
                <div class="col-md-2">
                  <div class="form-group">
                    <label for="" class="text-primary small1">{{"Auto Payout Threshold"|appTranslate|async}}</label>
                    <input [(ngModel)]="controlPayoutProduct.autoPayoutThreshold" type="number"
                      class="form-control control-bg-gray" />
                  </div>
                </div>
                <div class="col-md-auto ">
                  <div class="form-group">
                    <label for="" class="text-primary small1">{{"Auto Pay Suspense"|appTranslate|async}}</label>
                    <input [(ngModel)]="controlPayoutProduct.autoPaySuspense" type="checkbox"
                      class="form-control control-bg-gray">
                  </div>
                </div>
                <div class="col-md-auto ">
                  <div class="form-group">
                    <label for="" class="text-primary small1">{{"Auth Required Payout "|appTranslate|async}}</label>
                    <input [(ngModel)]="controlPayoutProduct.autoReqPayout" type="checkbox"
                      class="form-control control-bg-gray">
                  </div>
                </div>
                <div class="col-md-auto ">
                  <div class="form-group">
                    <label for=""
                      class=" text-primary small1">{{"Do not automatically pay premium from suspense"|appTranslate|async}}</label>
                    <input [(ngModel)]="controlPayoutProduct.payPremBfDue" type="checkbox"
                      class="form-control control-bg-gray">
                  </div>
                </div>
                <div class="col-md-auto ">
                  <div class="form-group">
                    <label for="" class=" text-primary small1">{{"Auth Required Quote"|appTranslate|async}}</label>
                    <input [(ngModel)]="controlPayoutProduct.authReqQuote" type="checkbox"
                      class="form-control control-bg-gray" />
                  </div>
                </div>
                <div class="col-md-auto ">
                  <div class="form-group">
                    <label for="" class="text-primary small1">{{"Control Required on Payout"|appTranslate|async}}</label>
                    <input [(ngModel)]="controlPayoutProduct.controlReqPayout" class="form-control control-bg-gray"
                      type="checkbox" />
                  </div>
                </div>
              </div>
            </div>
            <div class="col-auto d-flex">
              <app-btn [iconBtn]="true" icon="delete" type="danger-outline"
                [disabled]="createControlPayout?.controlPayoutProduct?.length==1" (mclick)="removePayoutProduct(i)"></app-btn>
              <span class="mx-1"></span>
              <app-btn [iconBtn]="true" icon="add" type="outline" (mclick)="addPayoutProduct(i+1)"></app-btn>
            </div>

          </div>
        </div>
 

        <div class="row mt-5">


        </div>

      </div>
      <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">
        <div class="row mt-3 justify-content-end">
          <div class="col-auto">
            <div class="form-group">
              <label for="" class=" text-primary">{{'Company Code'|appTranslate|async}}</label>
              <select class="form-control control-bg-gray" [disabled]="true"
                [value]="createControlPayout.controlPayout.companyCode">
                <option value=""></option>
                <option *ngFor="let item of companies" [value]="item.code">
                  {{item.code}} - {{item.description}}
                </option>
              </select>
            </div>
          </div>
        </div>

        <ng-container *ngFor="let controlPayoutPayout of createControlPayout.controlPayoutPayout; let i = index">
          <div class="row mt-3">
            <div class="col">
              <div class="form-group">
                <label for="" class="text-primary small1">{{"Payout Reason"|appTranslate|async}}</label>
              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <label for=""
                  class="text-primary small1">{{"Authorisation Required Payout "|appTranslate|async}}</label>
              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <label for="" class="text-primary small1">{{"Control Payout"|appTranslate|async}}</label>

              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <label for="" class="text-primary small1">{{"Control Threshold "|appTranslate|async}}</label>

              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <label for="" class="text-primary small1">{{"Auto Payout Threshold"|appTranslate|async}}</label>

              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <label for="" class="text-primary small1">{{"Control Required on Payout"|appTranslate|async}}</label>
              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <label for="" class="text-primary small1">{{"DV Requires Auth"|appTranslate|async}}</label>

              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <label for="" class="text-primary small1">{{"DV Auth Threshold"|appTranslate|async}}</label>
              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <label for="" class="text-primary small1">{{"Payout File Basis"|appTranslate|async}}</label>

              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <label for="" class="text-primary small1">{{"Payout File Format"|appTranslate|async}}</label>

              </div>
            </div>
            <div class="col">
              <div class="form-group">

              </div>
            </div>
          </div>
          <div class="row ">
            <div class="col">
              <div class="form-group ">
                <select name="" id="" [(ngModel)]="controlPayoutPayout.payoutReason"
                  class="form-control control-bg-gray">
                  <option value=""></option>
                  <option *ngFor="let item of payoutReasons" [value]="item.code">
                    {{item.code}} - {{item.title}}
                  </option>
                </select>
              </div>
            </div>
            <div class="col align-items-center d-flex">
              <div class="form-group">

                <input type="checkbox" [(ngModel)]="controlPayoutPayout.authReqPayout"
                  class="form-control control-bg-gray ">
              </div>
            </div>
            <div class="col align-items-center d-flex">
              <div class="form-group">

                <input type="checkbox" [(ngModel)]="controlPayoutPayout.controlPayout"
                  class="form-control control-bg-gray">
              </div>
            </div>
            <div class="col">
              <div class="form-group">

                <input [(ngModel)]="controlPayoutPayout.controlThreshold" type="number"
                  class="form-control control-bg-gray" />
              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <input type="number" [(ngModel)]="controlPayoutPayout.autoPayoutThreshold"
                  class="form-control control-bg-gray">
              </div>
            </div>
            <div class="col align-items-center d-flex">
              <div class="form-group">
                <input type="checkbox" [(ngModel)]="controlPayoutPayout.controlReqPayout"
                  class="form-control control-bg-gray">
              </div>
            </div>
            <div class="col align-items-center d-flex">
              <div class="form-group">
                <input type="checkbox" [(ngModel)]="controlPayoutPayout.dvReqAuth" class="form-control control-bg-gray">
              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <input type="number" [(ngModel)]="controlPayoutPayout.dvAuthThreshold"
                  class="form-control control-bg-gray">
              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <select [(ngModel)]="controlPayoutPayout.payoutBasis" class="form-control control-bg-gray">
                  <option value=""></option>
                  <option *ngFor="let item of payoutBasisFiled" [value]="item.code">
                    {{item.code}} - {{item.title}}
                  </option>
                </select>
              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <select [(ngModel)]="controlPayoutPayout.payoutFileFormatId" class="form-control control-bg-gray">
                  <option value=""></option>
                  <option *ngFor="let item of fileDownloads" [value]="item.code">
                    {{item.code}} - {{item.description}}
                  </option>
                </select>
              </div>
            </div>
            <div class="col">
              <div class="form-group">
                <app-button buttonType="delete" (click)="removePayoutPayout(i)"></app-button>
              </div>
            </div>
          </div>
        </ng-container>

        <div class="row mt-5 justify-content-end">
          <div class="col-2">
            <app-button buttonType="add" (click)="addPayoutPayout()"></app-button>
          </div>
        </div>

        <div class="row mt-5 justify-content-end">
          <div class="col-2">
            <app-button (click)="saveControlPayout()" buttonType="save"></app-button>
          </div>
        </div>
      </div>
    </div>


  </div>


</loader>
