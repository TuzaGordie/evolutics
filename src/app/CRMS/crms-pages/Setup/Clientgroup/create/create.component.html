<app-form-navigation [title]="'CRM / Setups / Client Group'"></app-form-navigation>
<div class="container-sm mt-5 " id="form-body">
  <form [formGroup]="clientGroupingForm">
  <div class="row g-3" >
    <div class="col-4">
      <div class="form-group mt-2">
        <label class="form-label text-red">{{'Group Code'|appTranslate|async}}</label>
        <input class="form-control  control-bg-gray" readonly="true" type="text" formControlName="clientGroup" />
      </div>
    </div>

    <div class="col-4">
      <div class="form-group mt-2">
        <label class="form-label text-red">{{'Company'|appTranslate|async}}</label>
        <select class="form-control  control-bg-gray" formControlName="company" (change)="onCompaniesChange()">
          <option></option>
          <option *ngFor="let company of companiesList" [ngValue]="company.code">{{company.code}} - {{company.description}}</option>
        </select>
      </div>
    </div>

    <div class="col-4">
      <div class="form-group mt-2">
        <label class="form-label text-red">{{'Client Band'|appTranslate|async}}</label>
        <div class="position-relative">
          <select class="form-control  control-bg-gray" formControlName="clientBand">
            <option></option>
            <option *ngFor="let cb of clientBandsList" [value]="cb.clientBand">{{cb.clientBand}} - {{cb.description}}</option>
          </select>
          <span class="position-absolute top-50 start-50 translate-middle" *ngIf="loadingClientBands">
            <span class="fa fa-spinner fa-spin"></span>
          </span>
        </div>
      </div>
    </div>



  </div>



  <div class="row g-3">

  <!-- <div class="col-4">
    <div class="form-group mt-2">
      <label class="form-label text-red">{{'Generalization'|appTranslate|async}}</label>
       no endpoint for generalization yet
         <select formControlName="generalization" class="form-control  control-bg-gray">
        <option></option>
        <option *ngFor="let gen of generalizationsList">{{gen}}</option>
      </select>
    </div>
  </div> -->
    <div class="col-6">
      <div class="form-group mt-2">
        <label class="form-label text-red">{{'Description'|appTranslate|async}}</label>
        <input class="form-control  control-bg-gray" type="text" formControlName="description" />
      </div>
    </div>

  </div>
  <hr>
  <div class="row g-3" *ngFor="let attribute of clientGroupAttributesForm.controls">
    <ng-container [formGroup]="$any(attribute)">
      <div class="col-4">
        <div class="form-group mt-2">
          <label class="form-label text-red">{{'Customer Attribute'|appTranslate|async}}</label>
          <select class="form-control  control-bg-gray" formControlName="customerAttribute">
            <option></option>
            <option *ngFor="let attribute of customerAttributesList" [value]="attribute.code">{{attribute.title}}</option>
          </select>
        </div>
      </div>
      <div class="col-2">
        <div class="form-group mt-2">
          <label class="form-label text-red">{{'Condition1'|appTranslate|async}}</label>
          <select class="form-control  control-bg-gray" formControlName="condition1">
            <option></option>
            <option *ngFor="let condition of conditionsList" [value]="condition.code">{{condition.code}} - {{condition.title}}</option>
        </select>
        </div>
      </div>

      <div class="col-2">
        <div class="form-group mt-2">
          <label class="form-label text-red">{{'Value'|appTranslate|async}}</label>
          <input class="form-control  control-bg-gray" type="text" formControlName="value1" />
        </div>
      </div>
      <div class="col-2">
        <div class="form-group mt-2">
          <label class="form-label text-red">{{'Condition2'|appTranslate|async}}</label>
          <select class="form-control  control-bg-gray" formControlName="condition2">
            <option></option>
            <option *ngFor="let condition of conditionsList" [value]="condition.code">{{condition.code}} - {{condition.title}}</option>
          </select>
        </div>
      </div>
      <div class="col-2">
        <div class="form-group mt-2">
          <label class="form-label text-red">{{'Value'|appTranslate|async}}</label>
          <input class="form-control  control-bg-gray" type="text" formControlName="value2" />
        </div>
      </div>
    </ng-container>
  </div>

  <div class="row g-3">
    <div class="col-2">
      <div class="form-group mt-2">
        <app-button buttonType="addred" (click)="addNewAttributesLine()"></app-button>
      </div>
    </div>
    <div class="col-8"></div>
    <div class="col-2">
      <div class="form-group mt-2">
        <app-btn [valid]="clientGroupingForm?.valid" (click)="submitClient()" icon="save" buttonType="submitRed">Submit</app-btn>
      </div>
    </div>
  </div>
</form>
</div>
